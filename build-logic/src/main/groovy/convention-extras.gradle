import java.lang.management.ManagementFactory

project.properties.ext.properties
    .toSorted { entry -> entry.key.toString().toLowerCase() }
    .forEach { k, v -> println("ext.properties $k=$v") }

project.properties
    .toSorted { entry -> entry.key.toLowerCase() }
    .forEach { k, v -> println("project.properties $k=$v") }

ManagementFactory.getRuntimeMXBean()
    .getInputArguments()
    .toSorted { arg -> arg.toLowerCase() }
    .forEach { arg -> println("jvmArgs $arg") }

System.getenv()
    .toSorted { entry -> entry.key.toLowerCase() }
    .forEach { k, v -> println("System.getenv $k=$v") }

System.getProperties()
    .entrySet()
    .toSorted { entry -> entry.key.toString().toLowerCase() }
    .forEach { entry -> println("System.getProperties ${entry.key}=${entry.value}") }

ext.isDevKitEnabled = { ->
    return getProperty("takrepo.url", null) != null
}

ext.getProperty = { String name, String defValue ->
    def prop = project.properties[name] ?:
        getValueFromPropertiesFile(project.rootProject.file("local.properties"), name)
    return (null == prop) ? defValue : prop
}

ext.getValueFromPropertiesFile = { File propFile, String key ->
    if (!propFile.isFile() || !propFile.canRead())
        return null
    def prop = new Properties()
    def reader = propFile.newReader()
    try {
        prop.load(reader)
    } finally {
        reader.close()
    }
    return prop.get(key)
}
